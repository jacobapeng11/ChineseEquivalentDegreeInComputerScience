# 第四章：搜索方法和启发式搜索

## 概述

搜索方法是人工智能的基础，提供探索问题可能解决方案的算法。本章涵盖系统搜索方法，包括无信息和有信息搜索，重点是有信息搜索方法，利用问题特定知识。

## 1. 问题求解智能体

### 搜索问题的组成部分
搜索问题包括：
1. **初始状态：** 问题的起点
2. **行动：** 可以应用于状态的可用操作
3. **转换模型：** 行动如何改变状态
4. **目标测试：** 确定状态是否为目标的标准
5. **路径成本：** 计算路径成本的函数

### 状态空间表示
- **状态空间：** 所有可能状态的集合
- **状态：** 情况的表示
- **解决方案：** 从初始状态到目标状态的路径
- **最优解决方案：** 成本最低的解决方案

## 2. 无信息搜索策略

无信息搜索（或盲目搜索）算法仅使用问题定义，而无需了解超出问题定义的状态的任何其他信息。

### 2.1 广度优先搜索（BFS）
**特点：**
- 逐层探索节点
- 使用FIFO（队列）数据结构
- 完整且对于统一成本问题是最佳的

**算法：**
```
1. 将初始状态添加到队列
2. 当队列不为空时：
   a. 从队列中移除第一个节点
   b. 如果是目标，返回解决方案
   c. 将所有子节点添加到队列末尾
```

**复杂度：**
- 时间：O(b^d) 其中b是分支因子，d是深度
- 空间：O(b^d) - 高空间需求
- 完整：是（如果b是有限的）
- 最优：是（如果路径成本是深度的非递减函数）

### 2.2 深度优先搜索（DFS）
**特点：**
- 沿每个分支尽可能深入探索
- 使用LIFO（栈）数据结构
- 完整但非最优

**算法：**
```
1. 将初始状态添加到栈
2. 当栈不为空时：
   a. 从栈顶移除节点
   b. 如果是目标，返回解决方案
   c. 将所有子节点添加到栈顶
```

**复杂度：**
- 时间：O(b^m) 其中m是最大深度
- 空间：O(bm) - 比BFS更节省空间
- 完整：否（无限深度空间）
- 最优：否

### 2.3 深度限制搜索
DFS与深度限制：l

### 2.4 迭代加深搜索（IDS）
通过逐渐增加深度限制来结合BFS和DFS的优势。

**优势：**
- DFS的空间复杂度
- BFS的完整性
- 步长成本为1时的最优性

**时间复杂度：** O(b^d)
**空间复杂度：** O(bd)

### 2.5 统一成本搜索（UCS）
基于路径成本而不是深度扩展节点。

**算法：**
- 使用按路径成本排序的优先队列
- 当所有步长成本相等时等同于BFS

## 3. 有信息搜索策略

有信息搜索（或启发式搜索）使用问题特定知识以更有效地找到解决方案。

### 3.1 启发式函数
启发式函数h(n)估计从节点n到目标节点的最便宜路径的成本。

**可采纳启发式：** 从不过估实际成本（乐观的）。
**一致启发式：** 对于每个节点n和后继n'及步长成本c，h(n) ≤ c(n,n') + h(n')。

### 3.2 贪婪最佳优先搜索
尝试扩展看起来最接近目标的节点。

**评估函数：** f(n) = h(n)（仅启发式）

### 3.3 A*搜索
结合统一成本搜索和贪婪最佳优先搜索。

**评估函数：** f(n) = g(n) + h(n)
- g(n) = 从起点到n的成本
- h(n) = 从n到目标的启发式估计

**特点：**
- 完整：是（如果b是有限的且h(n)有界）
- 最优：是（如果h(n)是可采纳的）
- 时间/空间：取决于启发式的质量

**A*的性质：**
- A*是有最优效率的：对于可采纳的树搜索算法，没有其他算法会比具有相同启发式的A*扩展更少的节点。
- 如果h(n) = h*(n)，A*在运行时间内是线性的

## 4. 约束满足问题（CSPs）

### CSP定义
CSP包括：
- 一组变量（X1, X2, ..., Xn）
- 每个变量的一组域（D1, D2, ..., Dn）
- 一组指定允许值的约束

**示例：** 地图着色、N皇后、数独

### CSP求解方法
1. **回溯搜索：** 在违反约束时回溯的系统方法
2. **前向检查：** 防止与当前分配冲突的分配
3. **约束传播：** 使用约束信息减少域大小

### 局部搜索方法
对于目标到路径不重要的优化问题。

#### 爬山算法
- 移向递增值的局部搜索算法
- 问题：局部最大值、山脊、高原

#### 模拟退火
- 允许一些"坏"移动以逃离局部最大值
- 温度参数控制坏移动的接受

#### 遗传算法
- 维护状态群体
- 使用选择、交叉和变异操作符

## 5. 对抗搜索

### 游戏玩家
具有交替移动和明确定义规则的双人游戏。

### 极小化极大算法
确定性、轮流、零和游戏的最优算法。

**算法：**
- MAX（我方）希望最大化效用
- MIN（对手）希望最小化效用
- 在MAX和MIN层级之间交替

**伪代码：**
```
函数 MINIMAX-DECISION(状态) 返回行动
   返回 argmax MIN-VALUE(RESULT(状态, a))
   
函数 MAX-VALUE(状态) 返回效用值
   如果 TERMINAL-TEST(状态) 则返回 UTILITY(状态)
   v ← -∞
   对于 ACTIONS(状态) 中的每个 a 做
      v ← MAX(v, MIN-VALUE(RESULT(状态, a)))
   返回 v
   
函数 MIN-VALUE(状态) 返回效用值
   如果 TERMINAL-TEST(状态) 则返回 UTILITY(状态)
   v ← +∞
   对于 ACTIONS(状态) 中的每个 a 做
      v ← MIN(v, MAX-VALUE(RESULT(状态, a)))
   返回 v
```

### Alpha-Beta剪枝
通过剪枝不影响最终决策的分支来改进极小化极大的效率的方法。

- α（alpha）：MAX沿路径在任何选择点找到的最佳值
- β（beta）：MIN沿路径在任何选择点找到的最佳值

## 6. 启发式函数设计

### 关键原则
1. **可采纳性：** 从不过估实际成本
2. **占优：** 如果h2(n) ≥ h1(n)对于所有n，则h2占优h1
3. **松弛问题：** 移除约束以获得可采纳启发式
4. **模式数据库：** 为子问题预计算到目标的精确成本

### 常见示例
**8数码问题：**
1. **错位启发式：** 计算错位的瓦片数量
2. **曼哈顿距离：** 计算瓦片到目标位置的距离之和

## 7. 搜索策略比较

| 算法 | 完整性？ | 最优性？ | 时间 | 空间 |
|------|----------|----------|------|------|
| BFS | 是* | 是* | O(b^d) | O(b^d) |
| DFS | 否 | 否 | O(b^m) | O(bm) |
| IDS | 是* | 是* | O(b^d) | O(bd) |
| UCS | 是* | 是 | O(b^C*/ε) | O(b^C*/ε) |
| 贪婪 | 否 | 否 | O(b^m) | O(b^m) |
| A* | 是* | 是* | O(b^d) | O(b^d) |

*如果有限状态空间且消除了冗余路径

## 练习题与解答

### 问题1：搜索空间分析
**问题：** 考虑分支因子b=3、目标深度d=4的搜索空间。计算BFS在找到解决方案之前生成的最大节点数。

**解答：**
BFS逐层探索节点。
- 第0层：1个节点（根节点）
- 第1层：3个节点
- 第2层：3² = 9个节点
- 第3层：3³ = 27个节点
- 第4层：3⁴ = 81个节点（目标在这）

总节点数 = 1 + 3 + 9 + 27 + 81 = 121个节点

### 问题2：A*算法
**问题：** 在A*搜索中，如果g(n) = 10且h(n) = 5，f(n)是什么？

**解答：**
f(n) = g(n) + h(n) = 10 + 5 = 15

### 问题3：启发式可采纳性
**问题：** 在网格上的路径规划问题中，曼哈顿距离用作启发式。这是可采纳的吗？为什么？

**解答：**
是的，曼哈顿距离是可采纳的，因为它从不过估实际成本：
- 它假设仅水平和垂直移动
- 实际路径成本将始终≥曼哈顿距离（对角移动会更有效）
- 由于它是低估（或在最佳情况下相等），所以是可采纳的

### 问题4：极小化极大评估
**问题：** 考虑一个MAX有3个可能移动的游戏树，对于每个移动，MIN有2个响应。如果终端值是[5, 3, 6, 2, 8, 1]，MAX应该选择哪个移动？

**解答：**
MIN在每层选择最小值：
- 移动1后：MIN选择min(5, 3) = 3
- 移动2后：MIN选择min(6, 2) = 2
- 移动3后：MIN选择min(8, 1) = 1

MAX选择最大值：max(3, 2, 1) = 3
MAX应该选择移动1。

### 问题5：搜索策略选择
**问题：** 对于分支因子大但解决方案浅的问题，哪种搜索策略最合适，为什么？

**解答：** 迭代加深搜索（IDS）最合适，因为：
- 它具有DFS的空间效率（O(bd)空间）
- 它具有BFS的完整性
- 它保证找到最浅的解决方案（对于统一成本是最佳的）
- 即使它重复工作，当解决方案浅时开销也是可接受的
- 它避免了BFS的空间复杂性，这对于大分支因子变得不可行

## 要点总结

- 无信息搜索方法在没有任何问题特定知识的情况下系统地探索
- 有信息（启发式）搜索方法使用问题特定知识来引导搜索
- 使用可采纳启发式时，A*是最优的
- 不同搜索策略在时间/空间/最优性上各有权衡
- 可采纳启发式从不过估实际成本
- 游戏玩家使用对抗搜索与极小化极大和Alpha-Beta剪枝

## 附加练习题

### 高级问题1：启发式可采纳性
**问题：** 对于8数码问题，哪个更可采纳：曼哈顿距离还是错位瓦片数？解释。

**解答：**
两者都是可采纳的，但曼哈顿距离更信息充分（占优），因为它考虑了每个瓦片必须移动的距离，而不仅仅是它是否在正确位置。由于曼哈顿距离从不过估实际成本并提供更好的估计，它通常会比错位瓦片启发式扩展更少的节点。

### 高级问题2：A* vs 贪婪搜索
**问题：** 在什么类型的问题中，你会更喜欢A*而不是贪婪最佳优先搜索？

**解答：**
当以下情况时，A*更优：
- 需要解决方案最优性
- 启发式是可采纳的
- 路径成本很重要
- 需要保证完整性
贪婪搜索在只有速度重要且不需要最优性时可能更优，尽管它可能找不到最优解决方案或甚至无法完成解决方案。