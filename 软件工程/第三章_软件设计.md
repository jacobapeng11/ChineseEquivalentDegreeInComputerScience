# 第三章：系统规约及软件设计

## 概述

系统规约及软件设计是软件工程的核心环节，它将需求规格说明转换为软件系统的体系结构。根据软件工程考纲要求，本章重点介绍结构化方法和面向对象方法两种主要的软件设计方法。

### 软件设计的概念

**软件设计的定义：**
软件设计是在需求分析的基础上，设计出满足需求的软件系统的体系结构、接口和数据结构的过程。设计阶段的目标是确定系统的实现方案。

**软件设计的目标：**
1. **正确性：** 设计应正确实现需求
2. **可理解性：** 设计应清晰易懂
3. **可维护性：** 设计应便于修改和维护
4. **可复用性：** 设计应考虑组件的可复用性
5. **可测试性：** 设计应便于测试
6. **高效性：** 设计应满足性能要求

### 软件设计的原则

1. **模块化：** 将系统分解为独立的模块
2. **抽象：** 忽略细节，关注本质特征
3. **信息隐藏：** 模块内部细节对外部不可见
4. **逐步求精：** 从抽象到具体的细化过程
5. **封装：** 将数据和操作封装在一起
6. **高内聚低耦合：** 模块内部高度相关、模块间低度依赖

## 结构化方法(学)

### 结构化分析

**结构化分析的特点：**
- 自顶向下、逐步求精
- 以数据流为中心
- 使用图形化工具表达系统功能

**结构化分析的工具：**

1. **数据流图(DFD)：**
   - 描述数据在系统中的流动和处理过程
   - 基本符号：
     - 外部实体：用矩形表示，表示系统的外部数据来源或去向
     - 处理过程：用圆或椭圆形表示，表示对数据的处理
     - 数据流：用箭头表示，表示数据的流动方向
     - 数据存储：用双线矩形表示，表示系统中存储的数据

2. **数据字典(DD)：**
   - 定义数据流图中所有元素的详细信息
   - 包括数据流、数据存储、处理过程的定义
   - 提供数据的名称、别名、描述、组成等信息

3. **加工说明：**
   - 描述处理过程的详细逻辑
   - 使用结构化语言、判定表、判定树等工具

### 结构化设计

**结构化设计的目标：**
将数据流图转换为软件结构图，建立模块化的软件结构。

**结构化设计的步骤：**

1. **变换分析：** 适用于变换型数据流图
   - 确定系统的逻辑输入、逻辑输出和变换中心
   - 设计系统的顶层模块结构
   - 逐步分解，设计下层模块

2. **事务分析：** 适用于事务型数据流图
   - 确定事务中心
   - 设计事务处理模块
   - 为每类事务设计处理模块

**软件结构图：**
- 模块：用矩形表示
- 调用关系：用箭头表示
- 层次关系：上层模块调用下层模块
- 信息传递：在调用线上标注数据信息

### 模块独立性

**内聚：** 模块内部元素之间的相关程度
- 偶然内聚 → 逻辑内聚 → 时间内聚 → 过程内聚 → 通信内聚 → 顺序内聚 → 功能内聚（从低到高）

**耦合：** 模块间相互依赖的程度
- 无直接耦合 → 数据耦合 → 特征耦合 → 控制耦合 → 公共耦合 → 内容耦合（从低到高）

**结构化设计原则：** 高内聚、低耦合

## 面向对象方法(学)

### 面向对象的基本概念

**对象：** 数据和操作的封装体，具有状态、行为和标识
**类：** 对象的模板或描述，定义了对象的属性和方法
**封装：** 将数据和操作包装在一起，隐藏内部实现
**继承：** 子类可以获得父类的属性和方法
**多态：** 同一消息可以有多种不同的响应

### 面向对象分析(OOA)

**面向对象分析的任务：**
1. 识别对象
2. 识别结构
3. 定义属性
4. 定义方法
5. 定义服务

**面向对象分析的模型：**
- **对象模型：** 描述对象的静态结构，用类图表示
- **动态模型：** 描述对象的动态行为，用状态图、序列图表示
- **功能模型：** 描述系统功能，用用例图、活动图表示

### 面向对象设计(OOD)

**面向对象设计原则：**

1. **单一职责原则(SRP)：** 一个类应该只有一个改变的理由
2. **开闭原则(OCP)：** 对扩展开放，对修改封闭
3. **里氏替换原则(LSP)：** 子类可以替换其父类
4. **依赖倒置原则(DIP)：** 依赖抽象，不依赖具体实现
5. **接口隔离原则(ISP)：** 使用多个专门接口比使用单一总接口更好
6. **迪米特法则(LoD)：** 一个对象应当对其他对象有尽可能少的了解

### 面向对象设计的步骤

1. **系统分解：** 将系统分解为子系统或部件
2. **问题领域部分设计：** 根据问题领域模型设计类和对象
3. **人机交互部分设计：** 设计用户界面和交互方式
4. **任务管理部分设计：** 设计系统中的任务和并发处理
5. **数据管理部分设计：** 设计数据存储和访问策略

### 统一建模语言(UML)

**UML图的类型：**
1. **用例图：** 描述系统的功能需求
2. **类图：** 描述系统的静态结构
3. **对象图：** 显示系统在特定时间点的对象实例
4. **序列图：** 描述对象间的交互顺序
5. **协作图：** 描述对象间的交互关系
6. **状态图：** 描述对象的状态转换
7. **活动图：** 描述业务流程和操作的工作流程
8. **组件图：** 描述系统的物理结构
9. **部署图：** 描述系统的物理部署

## 两种方法的比较

### 结构化方法与面向对象方法的比较

| 特征 | 结构化方法 | 面向对象方法 |
|------|------------|---------------|
| 分析策略 | 自顶向下、逐步求精 | 自底向上、逐步抽象 |
| 基本单元 | 功能/过程 | 对象/类 |
| 分析模型 | DFD、DD、加工说明 | 用例图、类图、序列图等 |
| 设计原则 | 模块化、抽象、信息隐藏 | 封装、继承、多态 |
| 适用系统 | 数据处理系统 | 复杂交互系统 |

**选择方法的考虑因素：**
- 系统类型和复杂性
- 开发团队的经验
- 项目要求和约束
- 维护和扩展需求

## 详细设计

### 详细设计的内容

1. **数据结构设计：** 详细设计内部数据结构
2. **算法设计：** 详细设计算法和处理流程
3. **接口设计：** 详细设计模块接口
4. **数据库设计：** 进行数据库的逻辑和物理设计
5. **用户界面设计：** 设计具体的用户界面

### 详细设计的表示方法

1. **程序流程图：** 用图形表示程序逻辑
2. **盒图(N-S图)：** 结构化的流程图
3. **PAD图：** 问题分析图
4. **过程设计语言(PDL)：** 伪代码
5. **判定表：** 表示复杂的条件组合
6. **判定树：** 表示决策逻辑

### 详细设计文档

**详细设计说明书包括：**
1. **引言：** 设计目标、术语定义
2. **系统结构：** 模块分解、调用关系
3. **模块设计：** 各模块详细设计
4. **接口设计：** 内部接口、外部接口
5. **数据结构：** 详细的数据结构定义
6. **算法设计：** 重要算法的详细描述
7. **数据库设计：** 数据库结构详细设计
8. **用户界面设计：** 界面详细设计

## 本章练习题

### 选择题

1. 在结构化方法中，描述数据在系统中流动的工具是：
   A. 数据字典
   B. 数据流图
   C. 加工说明
   D. 系统流程图

2. 面向对象方法的三大模型不包括：
   A. 对象模型
   B. 动态模型
   C. 功能模型
   D. 数据模型

3. 按照内聚程度从高到低排列，正确的是：
   A. 功能内聚 → 顺序内聚 → 通信内聚
   B. 通信内聚 → 顺序内聚 → 功能内聚
   C. 顺序内聚 → 功能内聚 → 通信内聚
   D. 功能内聚 → 通信内聚 → 顺序内聚

4. 开闭原则的含义是：
   A. 对扩展开放，对修改封闭
   B. 对修改开放，对扩展封闭
   C. 对继承开放，对组合封闭
   D. 对组合开放，对继承封闭

5. 在数据流图中，用圆或椭圆形表示的是：
   A. 外部实体
   B. 处理过程
   C. 数据流
   D. 数据存储

### 简答题

6. 比较结构化方法与面向对象方法的主要特点。

7. 解释面向对象方法中封装、继承、多态的含义。

8. 说明结构化设计中变换分析的步骤。

## 本章练习题答案解析

### 选择题答案

1. **答案：B**
   - 解析：在结构化方法中，数据流图(DFD)用于描述数据在系统中的流动和处理过程。

2. **答案：D**
   - 解析：面向对象方法的三大模型是对象模型、动态模型、功能模型，不包括数据模型。

3. **答案：A**
   - 解析：内聚程度从高到低：功能内聚 → 顺序内聚 → 通信内聚 → 过程内聚 → 时间内聚 → 逻辑内聚 → 偶然内聚。

4. **答案：A**
   - 解析：开闭原则(OCP)指对扩展开放，对修改封闭。

5. **答案：B**
   - 解析：在数据流图中，用圆或椭圆形表示处理过程。

### 简答题答案

6. **答案：**
   结构化方法：
   - 分析策略：自顶向下、逐步求精
   - 基本单元：功能/过程
   - 工具：数据流图、数据字典、加工说明
   - 特点：功能分解、数据流为中心
   - 适用：数据处理密集型系统

   面向对象方法：
   - 分析策略：自底向上、逐步抽象
   - 基本单元：对象/类
   - 工具：UML图（用例图、类图、序列图等）
   - 特点：封装、继承、多态
   - 适用：复杂交互型系统

7. **答案：**
   封装：将数据和操作包装在一个对象中，隐藏内部实现细节，仅通过接口与外界交互。

   继承：子类可以继承父类的属性和方法，实现代码重用和层次化设计。

   多态：同一操作作用于不同的对象可以有不同的解释，产生不同的执行结果。

8. **答案：**
   变换分析的步骤：
   1) 确认变换特征：识别系统的逻辑输入、变换中心和逻辑输出
   2) 设计顶层结构：设计主控制模块和输入、输出、变换模块
   3) 设计下层结构：逐步分解各功能模块
   4) 设计优化：优化模块结构，提高模块独立性
