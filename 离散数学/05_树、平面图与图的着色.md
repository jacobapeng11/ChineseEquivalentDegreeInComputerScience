# 第5章 树、平面图与图的着色

## 5.1 树的定义及等价条件

### 5.1.1 树的定义

**树**是一个连通且无回路的无向图。如果图有多个连通分量，每个连通分量都是树，则称该图是**森林**。

### 5.1.2 树的等价定义

对于具有n个顶点的无向图G，以下各条件等价：
1. G是树（连通且无回路）
2. G无回路且有n-1条边
3. G连通且有n-1条边
4. G无回路，但在任意两个不相邻顶点间加一条边后，恰有一个回路
5. G连通，但删除任意一条边后不再连通
6. G中任意两个顶点间有唯一通路

### 5.1.3 树的基本性质

1. 任意树中必有至少一个度数为1的顶点（悬挂点）
2. 树中所有顶点度数之和为2(n-1)，其中n是顶点数
3. 树中任意两个顶点间都有唯一路径
4. 任意树都是二部图

## 5.2 支撑树的计数

### 5.2.1 支撑树的定义

对于图G，若其子图T是树且包含G的所有顶点，则称T是G的**支撑树**（或**生成树**）。

### 5.2.2 支撑树的性质

1. 任意连通图都有支撑树
2. 图G有支撑树当且仅当G连通
3. n阶连通图G的支撑树有n-1条边，所以需要从G中删除ε(G)-(n-1)条边，其中ε(G)是G的边数

### 5.2.3 Cayley公式

**定理5.2.1**（Cayley公式）：n个标定顶点的树的棵数为n^(n-2)。

### 5.2.4 矩阵树定理

**定理5.2.2**（矩阵树定理）：无向图的支撑树个数等于其基尔霍夫矩阵的任意一个n-1阶主子式的值。

**基尔霍夫矩阵**K = (kᵢⱼ)定义为：
- kᵢᵢ = deg(vᵢ)（顶点vᵢ的度数）
- kᵢⱼ = -1（若vᵢ与vⱼ相邻）
- kᵢⱼ = 0（若vᵢ与vⱼ不相邻）

**例5.2.1** 求完全图K₄的支撑树个数。
由Cayley公式：4^(4-2) = 4² = 16

## 5.3 森林

### 5.3.1 森林的定义

**森林**是无回路的图，即每个连通分量都是树的图。

### 5.3.2 森林的性质

若森林有n个顶点，k个连通分量，则它有n-k条边。

## 5.4 最短树

### 5.4.1 最小生成树

对于带权图，**最小生成树**（MST）是权重和最小的生成树。

### 5.4.2 最小生成树算法

#### Kruskal算法
1. 将所有边按权重从小到大排序
2. 依次考虑每条边，若加入当前边不形成回路，则加入
3. 直到树中有n-1条边

#### Prim算法
1. 任选一个顶点作为初始树
2. 选择与当前树关联的权重最小的边，扩展树
3. 重复步骤2直到包含所有顶点

## 5.5 平面图与极大平面图

### 5.5.1 平面图的定义

如果一个图能够画在平面上，使得任意两条边除了在顶点处外不相交，则称该图为**平面图**。图的这种画法称为**平面嵌入**。

### 5.5.2 面的概念

在平面图的平面嵌入中，边围成的区域称为**面**。围成面的边数称为该面的**次数**，围外面的区域称为**外部面**。

### 5.5.3 欧拉公式

**定理5.5.1**（欧拉公式）：设G是连通的平面图，有n个顶点，ε条边，r个面，则：
n - ε + r = 2

**推论**：设G是n(≥3)阶简单平面图，则ε ≤ 3n - 6。

### 5.5.4 Kuratowski定理

**定理5.5.2**（Kuratowski定理）：图G是平面图当且仅当它不含与K₅或K₃,₃同胚的子图。

- K₅：5个顶点的完全图
- K₃,₃：3,3-完全二部图

### 5.5.5 极大平面图

若在图G的任意两个不相邻顶点间连边后得到的图不再是平面图，则称G为**极大平面图**。

对n(≥3)阶极大平面图，有ε = 3n - 6，且每个面的次数为3。

## 5.6 对偶图

### 5.6.1 对偶图的定义

设G是平面图的一个平面嵌入，其对偶图G*构造如下：
- G*的每个顶点对应G的每个面
- G*中两个顶点相连当且仅当它们对应的面在G中有一条公共边
- G*的每条边对应G的一条边

### 5.6.2 对偶图的性质

1. (G*)* = G
2. G的顶点数 = G*的面数
3. G的边数 = G*的边数
4. G的面数 = G*的顶点数

## 5.7 色数与色多项式

### 5.7.1 图的着色

**k-着色**：用k种颜色对图的顶点着色，使相邻顶点不同色。
**色数**χ(G)：使G有k-着色的最小k值。

### 5.7.2 色多项式

**色多项式**P(G,λ)是关于λ的多项式，P(G,k)表示用k种颜色对G着色的方案数。

**基本公式**：P(G,λ) = P(G-e,λ) - P(G·e,λ)
其中G-e是删除边e得到的图，G·e是收缩边e得到的图。

### 5.7.3 特殊图的色数

1. 完全图Kₙ的色数：χ(Kₙ) = n
2. 树的色数：χ(T) = 2（非平凡树）
3. 二部图的色数：χ(G) ≤ 2，等于2当且仅当G非空
4. 轮图Wₙ的色数：χ(Wₙ) = 3（当n为奇数），χ(Wₙ) = 4（当n为偶数）

### 5.7.4 四色定理

**四色定理**：任意平面图的色数不超过4。

### 5.7.5 Brooks定理

**定理5.7.1**（Brooks定理）：若连通图G不是完全图也不是奇圈，则χ(G) ≤ Δ(G)，其中Δ(G)是图G的最大度数。

## 5.8 根树

### 5.8.1 根树的定义

将树的一点指定为**根**，从根到其他顶点有唯一通路的有向树称为**根树**（或**有根树**）。

### 5.8.2 根树的相关术语

- **层**：根到顶点的路径长度
- **高度**：树中顶点的最大层数
- **叶子**：度数为1的顶点（除根外）
- **内部顶点**：非叶子顶点
- **父亲**、**儿子**：在有向路径中，靠近根的是父亲，远离根的是儿子
- **祖先**、**后代**：沿路径向上是祖先，向下是后代

### 5.8.3 m叉树与二叉树

- **m叉树**：任意顶点的儿子数不超过m的根树
- **完全m叉树**：任意非叶子顶点都恰好有m个儿子的m叉树
- **二叉树**：2叉树

### 5.8.4 有序根树

规定了儿子左右顺序的根树称为**有序根树**。

## 5.9 二叉树的应用

### 5.9.1 二叉搜索树

对于二叉树中任意顶点v：
- 左子树中所有顶点的值都小于v
- 右子树中所有顶点的值都大于v

### 5.9.2 前缀码

在二叉树中，从根到叶子的路径可以用0（左）和1（右）表示，形成前缀码。

## 本章小结

1. 树是连通无回路的图，有多种等价定义
2. 生成树是包含原图所有顶点的树子图
3. Cayley公式给出n个顶点的标定树的个数
4. 平面图可画在平面上边不相交
5. 欧拉公式联系了平面图的顶点数、边数和面数
6. Kuratowski定理给出平面图的判定条件
7. 图的着色是相邻顶点着不同颜色
8. 根树是选定根的树，有广泛的应用
9. 二叉树在计算机科学中有重要应用

## 课后练习

### 选择题

1. 在任意n阶树中，边的数目为：
   A. n
   B. n-1
   C. n+1
   D. 2n

2. 设G是n(≥3)阶简单平面图，ε为边数，则：
   A. ε ≤ 2n - 4
   B. ε ≤ 3n - 6
   C. ε ≤ 4n - 8
   D. ε ≤ n(n-1)/2

3. n个顶点的标定树的棵数为：
   A. n^(n-1)
   B. n^(n-2)
   C. n^(n-3)
   D. n^(n-4)

### 解答题

1. 证明：n阶树中至少有两片叶子（度数为1的顶点）。

2. 用Kruskal算法求下图的最小生成树，图的边及权重如下：
   (A,B)=6, (A,D)=5, (B,C)=3, (B,D)=2, (B,E)=5, (C,E)=6, (D,E)=6, (D,F)=4, (E,F)=1

3. 已知简单连通平面图有9个顶点，12条边，问它有几个面？并验证欧拉公式。

4. 求4个顶点的完全图K₄的色多项式，并计算其色数。

5. 证明：任意图G中，χ(G) ≥ ω(G)，其中ω(G)是G中最大团的顶点数。

### 练习题答案

#### 选择题

1. B - 树的性质：n阶树有n-1条边
2. B - 平面图的性质：ε ≤ 3n - 6
3. B - Cayley公式：n^(n-2)

#### 解答题

1. 证明：
   用反证法。假设n阶树T最多只有一片叶子（度数为1的顶点）。
   
   设T中有nᵢ个度数为i的顶点，则：
   - n₁ ≤ 1（最多一片叶子）
   - n₁ + n₂ + ... + nₙ = n
   - 2(n-1) = 1×n₁ + 2×n₂ + ... + n×nₙ（握手定理）
   
   因为T至少有两个顶点（否则不是树），所以n ≥ 2
   若n₁ = 0，则所有顶点度数≥2，从而2(n-1) = Σ i×nᵢ ≥ 2(n₂ + ... + nₙ) = 2(n-n₁) = 2n，
   所以2n-2 ≥ 2n，得-2 ≥ 0，矛盾。
   
   若n₁ = 1，则n₂ + ... + nₙ = n-1，且
   2(n-1) = 1×1 + Σ i×nᵢ ≥ 1 + 2(n-1) = 2n-1，
   所以2n-2 ≥ 2n-1，得-1 ≥ 0，矛盾。
   
   因此至少有两个度数为1的顶点，即至少有两片叶子。

2. 解：
   按边权重排序：(E,F)=1, (B,D)=2, (D,F)=4, (A,D)=5, (A,B)=6, (B,C)=3, (B,E)=5, (C,E)=6, (D,E)=6
   
   按Kruskal算法：
   1) 选择(E,F)=1
   2) 选择(B,D)=2
   3) 选择(D,F)=4 (B-F不直接连通)
   4) 选择(A,D)=5
   5) 选择(B,C)=3
   6) 选择(B,E)=5 (检查是否会形成回路，不形成)
   
   最小生成树的边集：{(E,F), (B,D), (D,F), (A,D), (B,C), (B,E)}，权重和为1+2+4+5+3+5=20

3. 解：
   由欧拉公式：n - ε + r = 2
   其中n=9, ε=12，所以 r = 2 - n + ε = 2 - 9 + 12 = 5
   所以有5个面。
   
   验证：9 - 12 + 5 = 2，正确。

4. 解：
   K₄是4个顶点的完全图，任意两个顶点间都有边。
   
   求色多项式：
   P(K₄,λ) = λ(λ-1)(λ-2)(λ-3)
   这是因为：第1个顶点有λ种颜色可选，第2个顶点有λ-1种，第3个顶点有λ-2种，第4个顶点有λ-3种。
   
   色数计算：
   最小的k使P(K₄,k)>0，即k(k-1)(k-2)(k-3)>0
   当k<4时，多项式值为0；当k≥4时，值为正。
   所以χ(K₄) = 4

5. 证明：
   设G中最大团的顶点数为ω(G)，即G中完全子图K_{ω(G)}的最大阶数。
   
   在任意正常着色方案中，完全子图K_{ω(G)}的ω(G)个顶点必须两两着不同颜色。
   因为K_{ω(G)}中任意两个顶点都相邻，所以至少需要ω(G)种颜色。
   
   由于这是着色的必要条件，所以任意正常的着色方案至少需要ω(G)种颜色。
   因此，χ(G) ≥ ω(G)。