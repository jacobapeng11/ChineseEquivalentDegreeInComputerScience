# 第10章 Polya定理

## 10.1 Burnside引理

### 10.1.1 置换群的基本概念

**定义10.1.1** 设X是一个有限集合，G是X上的置换群。对于x∈X，定义：
- **x的稳定子群**：Gx = {g∈G | g(x) = x}
- **x的轨道**：Ox = {g(x) | g∈G}

**定理10.1.1**（轨道-稳定子定理）对于置换群G中的任意元素x，有：
|G| = |Ox| × |Gx|

### 10.1.2 Burnside引理的表述

**定理10.1.2**（Burnside引理）设G是有限集合X上的置换群，则在G的作用下X的轨道数为：
轨道数 = (1/|G|) Σ_{g∈G} |F(g)|
其中F(g) = {x∈X | g(x) = x}表示g的不动点集合。

**等价形式**：轨道数 = (1/|G|) Σ_{g∈G} 不动点个数(g)

### 10.1.3 Burnside引理的应用

**例10.1.1** 求用2种颜色给正方形的顶点着色，在旋转群作用下本质不同的着色方案数。

解：正方形的旋转群G = {e, r, r², r³}，其中r是旋转90°的置换。
- e（恒等置换）：不动点数 = 2⁴ = 16
- r, r³（旋转90°, 270°）：不动点数 = 2¹ = 2（4个顶点必须同色）
- r²（旋转180°）：不动点数 = 2² = 4（对角顶点必须同色）

轨道数 = (1/4)(16 + 2 + 4 + 2) = 24/4 = 6

## 10.2 Polya定理

### 10.2.1 Polya定理的表述

**定理10.2.1**（Polya计数定理）设G是n个对象的置换群，用m种颜色对n个对象着色，则在G的作用下本质不同的着色方案数为：
P = (1/|G|) Σ_{g∈G} m^{c(g)}
其中c(g)表示置换g的轮换个数（循环节数）。

### 10.2.2 循环指标

设G是n个对象的置换群，对于g∈G，设g有jₖ(g)个长为k的轮换，则g的**型**为(j₁(g), j₂(g), ..., jₙ(g))。

G的**循环指标**为：
P_G(x₁, x₂, ..., xₙ) = (1/|G|) Σ_{g∈G} x₁^{j₁(g)} x₂^{j₂(g)} ... xₙ^{jₙ(g)}

则用m种颜色着色的方案数为P_G(m, m, ..., m)。

### 10.2.3 Polya定理的应用

**例10.2.1** 用3种颜色给正三角形的顶点着色，考虑旋转和翻转，求本质不同的着色方案数。

解：正三角形的对称群为D₃（6阶），包括：
- 恒等元e：型为(3,0,0)，轮换个数=3
- 120°旋转r：型为(0,0,1)，轮换个数=1
- 240°旋转r²：型为(0,0,1)，轮换个数=1
- 关于高线的翻转（3种）：型为(1,1,0)，轮换个数=2

着色方案数 = (1/6)(3³ + 3¹ + 3¹ + 3×3²) = (1/6)(27 + 3 + 3 + 27) = 60/6 = 10

## 10.3 母函数型的Polya定理

### 10.3.1 加权的Polya定理

当不同颜色有不同"权值"或"重量"时，可用加权的Polya定理来计数。

设有权函数w，将颜色集C映射到一个交换环R上的元素，w(c)称为颜色c的权值。

对一种着色f，定义其权值为w(f) = Π w(f(x))，其中乘积取遍所有对象x。

### 10.3.2 母函数形式的Polya定理

如果颜色i的权值为wᵢ，则本质不同着色的权值之和为：
(1/|G|) Σ_{g∈G} Π_{k=1}^n (Σᵢ wᵢᵏ)^{jₖ(g)}

特别是，当wᵢ = xᵢ时，得到计数的母函数。

## 10.4 图的计数

### 10.4.1 标号图与非标号图

- **标号图**：顶点有固定标号的图
- **非标号图**：只考虑图的结构，不考虑顶点标号

### 10.4.2 用Polya定理计数简单图

设G是n个顶点的置换群，则在G作用下，顶点集为{1,2,...,n}的简单图的个数可由Polya定理计算。

对于边的着色问题，需要考虑边置换群的作用。

**例10.4.1** 求n个顶点的非标号图的个数。

解：需要考虑顶点标号的置换对边集合的作用。
对顶点置换g，它对应的边置换的轮换个数与g的型有关。

### 10.4.3 具有特定性质的图的计数

可以使用带权的Polya定理来计数具有特定性质的图，如给定度序列的图、二部图等。

## 10.5 项链问题

### 10.5.1 项链的计数

项链问题是最经典的Polya定理应用之一。

**例10.5.1** 用m种颜色制作n颗珠子的项链，求本质不同的项链数。

解：考虑二面体群Dₙ的作用，包括：
- n个旋转：对于旋转k×(2π/n)角度的置换，轮换个数为gcd(n,k)
- n个翻转（当n为偶数和奇数时略有不同）

### 10.5.2 特殊情况

- **只有旋转**：循环群Cₙ
- **旋转+翻转**：二面体群Dₙ

## 10.6 Polya定理的扩展

### 10.6.1 Redfield-Polya定理

Redfield-Polya定理是Polya定理在更一般情况下的扩展，可以处理多个参数的计数问题。

### 10.6.2 模颜色限制的计数

当某些颜色在某些位置的使用有数量限制时，可以使用更复杂的计数方法。

## 10.7 实际应用

### 10.7.1 化学中的同分异构体计数

Polya定理在化学中用于计算同分异构体的数目。

### 10.7.2 电路设计

在电路设计中用于计数不同结构的电路。

### 10.7.3 模式识别

在模式识别和计算机图形学中用于计数不同的模式。

## 本章小结

1. Burnside引理提供了计算轨道数的基本方法
2. Polya定理是计数在群作用下对象的有力工具
3. 循环指标是Polya定理的重要组成部分
4. 母函数形式的Polya定理支持加权计数
5. 应用范围广泛，包括图论、化学、物理等领域
6. 项链问题是Polya定理的经典应用

## 课后练习

### 选择题

1. 在Burnside引理中，轨道数的计算公式是：
   A. (1/|G|) Σ |F(g)|
   B. Σ |F(g)|
   C. |G| × Σ |F(g)|
   D. |F(g)|/|G|

2. 用2种颜色对正方形4条边着色，在旋转群作用下，恒等变换的不动点个数是：
   A. 2
   B. 4
   C. 8
   D. 16

3. 二面体群D₄（正方形的对称群）的阶数是：
   A. 4
   B. 6
   C. 8
   D. 12

### 解答题

1. 用3种颜色给正四面体的4个顶点着色，在旋转群作用下求本质不同的着色方案数。

2. 用2种颜色制作4颗珠子的项链，考虑旋转和翻转，求本质不同的项链数。

3. 用Redfield-Polya定理，计算用红、蓝两种颜色给正方形4条边着色，且恰用2种颜色的方案数。

4. 求n个顶点的有向树的个数（考虑同构）。

5. 用Polya定理求解：用m种颜色给n个珠子的项链着色，求本质不同的着色方案数。

### 练习题答案

#### 选择题

1. A - Burnside引理的标准形式：轨道数 = (1/|G|) Σ_{g∈G} |F(g)|
2. D - 恒等变换下，每条边都可以独立选择2种颜色，所以不动点个数是2⁴=16
3. C - D₄包括4个旋转和4个翻转，共8个元素

#### 解答题

1. 解：
   正四面体的旋转群是A₄（12个元素）：
   - 恒等元：轮换个数=4，不动点数=3⁴=81
   - 8个顶点的3阶轮换（旋转轴过顶点和对面中心）：轮换个数=1，不动点数=3¹=3
   - 3个边的2阶轮换（旋转轴过对边中点）：轮换个数=2，不动点数=3²=9
   
   本质不同的着色数 = (1/12)(81 + 8×3 + 3×9) = (1/12)(81 + 24 + 27) = 132/12 = 11

2. 解：
   二面体群D₄作用于4个珠子：
   - 恒等元e：轮换个数=4，不动点数=2⁴=16
   - 旋转π/2, 3π/2：轮换个数=1，不动点数=2¹=2
   - 旋转π：轮换个数=2，不动点数=2²=4
   - 关于对角线的翻转（2个）：轮换个数=2，不动点数=2²=4
   - 关于对边中点连线的翻转（2个）：轮换个数=2，不动点数=2²=4
   
   项链数 = (1/8)(16 + 2×2 + 4 + 2×4 + 2×4) = (1/8)(16 + 4 + 4 + 8 + 8) = 40/8 = 5

3. 解：
   先计算所有着色方案数，再减去只用一种颜色的方案数。
   
   正方形边的着色，D₄作用：
   - e: 轮换个数=4
   - r, r³: 轮换个数=1
   - r²: 轮换个数=2
   - 关于对角线的翻转: 轮换个数=2（2个）
   - 关于对边中点连线的翻转: 轮换个数=2（2个）
   
   所有着色数 = (1/8)(2⁴ + 2×2¹ + 2² + 2×2² + 2×2²) = (1/8)(16 + 4 + 4 + 8 + 8) = 40/8 = 5
   
   只用一种颜色的方案数对应于全红或全蓝：2种
   
   恰用2种颜色的方案数 = 5 - 2 = 3

4. 解：
   这是一个复杂问题，涉及树的计数理论。
   令t(n)表示n个标号顶点的有向树个数，则由Cayley公式，t(n) = n^(n-1)。
   
   但题目要求考虑同构（非标号树），这是Pólya理论的应用：
   需要计算在Sₙ作用下根树的轨道数。
   
   这个问题的解涉及复杂的递推关系和母函数技术，结果是：
   令T(x) = Σ t(n)xⁿ/n!，其中t(n)是n个顶点非标号有向树的个数，
   则T满足函数方程 T = xe^T。

5. 解：
   n颗珠子的项链计数，使用二面体群Dₙ：
   
   旋转：对于旋转2πk/n的置换（k=0,1,...,n-1），轮换个数为gcd(n,k)
   翻转：对于翻转，当n为奇数时，轮换个数为(n+1)/2；当n为偶数时，分两种翻转，轮换个数分别为n/2+1和n/2
   
   设n为偶数：
   项链数 = (1/2n)[Σ_{k=0}^{n-1} m^gcd(n,k) + (n/2)m^{n/2+1} + (n/2)m^{n/2}]
          = (1/2n)[Σ_{k=0}^{n-1} m^gcd(n,k) + nm^{n/2}((m+1)/2)]
          = (1/2n)Σ_{k=0}^{n-1} m^gcd(n,k) + (1/2)m^{n/2} + (1/2)m^{n/2+1}
   
   设n为奇数：
   项链数 = (1/2n)[Σ_{k=0}^{n-1} m^gcd(n,k) + nm^{(n+1)/2}]