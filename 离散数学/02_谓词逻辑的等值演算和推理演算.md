# 第2章 谓词逻辑的等值演算和推理演算

## 2.1 谓词、量词的基本概念及表示法

### 2.1.1 谓词的概念

在命题逻辑中，我们只能处理简单命题，无法揭示命题的内部结构。为了更深入地分析命题，我们需要引入谓词逻辑。

**谓词**：表示对象性质或对象间关系的语法成分，记为P(x₁, x₂, ..., xₙ)。

- **个体词**：可以独立存在的具体或抽象的客体
- **个体域**：个体变动的范围
- **谓词**：刻画个体性质或个体间关系的词

**例2.1.1** 
- "a是素数" → P(a)，其中P(x)表示"x是素数"
- "a与b有关系L" → L(a,b)，其中L(x,y)表示"x与y有关系L"

### 2.1.2 量词

谓词逻辑中有两种量词：

1. **全称量词(∀)**：∀x表示"对所有的x"、"对任意的x"
2. **存在量词(∃)**：∃x表示"存在x"、"至少有一个x"

**例2.1.2**
- ∀x P(x)：对所有x，P(x)成立
- ∃x P(x)：存在x，使得P(x)成立

### 2.1.3 谓词公式的定义

1. **原子谓词公式**：由谓词符号和个体词或个体变元构成的表达式
2. **合式公式**（谓词公式）的递归定义：
   - 原子谓词公式是合式公式
   - 若A是合式公式，则¬A是合式公式
   - 若A、B是合式公式，则A∧B, A∨B, A→B, A↔B是合式公式
   - 若A是合式公式，则∀xA, ∃xA是合式公式
   - 只有有限次应用以上规则得到的符号串是合式公式

## 2.2 复杂自然语句的形式化

谓词逻辑的目的是将复杂的自然语言语句转化为逻辑公式，便于精确分析。

**例2.2.1** 形式化："所有人的朋友都是人"

定义：
- H(x): x是人
- F(x,y): x是y的朋友

形式化为：∀x∀y(H(y) ∧ F(x,y) → H(x))

**例2.2.2** 形式化："有学生的老师不是学生的家长"

定义：
- S(x): x是学生
- T(x): x是老师
- P(x): x是家长
- R(x,y): x是y的…

形式化为：∃x∃y(S(y) ∧ T(x) ∧ R(x,y) ∧ ¬P(x))

**例2.2.3** 形式化："没有不犯错误的人"

定义：
- H(x): x是人
- M(x): x犯错误

形式化为：¬∃x(H(x) ∧ ¬M(x)) 或 ∀x(H(x) → M(x))

## 2.3 否定型等值式

### 2.3.1 量词否定等值式

1. ¬∀xA(x) ⇔ ∃x¬A(x)
2. ¬∃xA(x) ⇔ ∀x¬A(x)

这两个等值式表明，全称量词的否定等于存在量词对否定的约束，存在量词的否定等于全称量词对否定的约束。

**例2.3.1** 
- "并非所有人都是老师" ⇔ "存在不是老师的人" 
- ¬∀x(T(x)) ⇔ ∃x(¬T(x))

### 2.3.2 量词辖域的扩张与收缩

1. ∀x(A(x) ∧ B) ⇔ ∀xA(x) ∧ B  （B不含x的自由出现）
2. ∀x(A(x) ∨ B) ⇔ ∀xA(x) ∨ B  （B不含x的自由出现）
3. ∃x(A(x) ∧ B) ⇔ ∃xA(x) ∧ B  （B不含x的自由出现）
4. ∃x(A(x) ∨ B) ⇔ ∃xA(x) ∨ B  （B不含x的自由出现）
5. ∀x(A(x) → B) ⇔ ∃xA(x) → B  （B不含x的自由出现）
6. ∀x(B → A(x)) ⇔ B → ∀xA(x)  （B不含x的自由出现）
7. ∃x(A(x) → B) ⇔ ∀xA(x) → B  （B不含x的自由出现）
8. ∃x(B → A(x)) ⇔ B → ∃xA(x)  （B不含x的自由出现）

## 2.4 量词分配等值式

### 2.4.1 量词对合取和析取的分配

1. ∀x(A(x) ∧ B(x)) ⇔ ∀xA(x) ∧ ∀xB(x)
2. ∃x(A(x) ∨ B(x)) ⇔ ∃xA(x) ∨ ∃xB(x)

**注意**：以下等值式不成立
- ∀x(A(x) ∨ B(x)) ⇎ ∀xA(x) ∨ ∀xB(x)
- ∃x(A(x) ∧ B(x)) ⇎ ∃xA(x) ∧ ∃xB(x)

**反例**：
- 左边表示：对任意x，A(x)和B(x)至少有一个成立
- 右边表示：A(x)对所有x成立或B(x)对所有x成立

这两个不一定等价。

## 2.5 范式

### 2.5.1 前束范式

一个谓词公式W称为**前束范式**，如果它具有如下形式：
Q₁x₁Q₂x₂...QₖxₖM

其中：
- Qᵢ (i=1,2,...,k) 为量词∀或∃
- M为不含量词的谓词公式（称为母式或矩阵）
- x₁, x₂, ..., xₖ为客体变元

**例2.5.1** 
- ∀x∀y∃z(P(x,y) → Q(x,z)) 是前束范式
- ∀x(P(x) ∧ ∃yQ(y)) 不是前束范式

### 2.5.2 前束范式的求法

将谓词公式化为前束范式的方法：
1. 消去多余的量词符号
2. 将约束变元改名，使不同量词约束的变元名称各异
3. 利用量词等值式把量词移到公式最前端

**例2.5.2** 将公式 ∀xP(x) ∨ ∃yQ(y) → ∀xR(x) 化为前束范式：

解：
1. 先换名：∀xP(x) ∨ ∃yQ(y) → ∀zR(z)
2. 利用蕴含等值式：¬(∀xP(x) ∨ ∃yQ(y)) ∨ ∀zR(z)
3. 德摩根定律：(¬∀xP(x) ∧ ¬∃yQ(y)) ∨ ∀zR(z)
4. 量词否定：(∃x¬P(x) ∧ ∀y¬Q(y)) ∨ ∀zR(z)
5. 辖域扩张：∃x∀y∀z((¬P(x) ∧ ¬Q(y)) ∨ R(z))

## 2.6 Skolem标准形

**Skolem标准形**是特殊的前束范式，其母式为合取范式，且所有存在量词都在全称量词之前。

**Skolem函数**：为了消除存在量词，引入的函数，其变元为该存在量词左边的所有全称量词的指导变元。

**求Skolem标准形的步骤**：
1. 化为前束范式
2. 消去存在量词，用Skolem函数代替相应变元

**例2.6.1** 将∀x∃yP(x,y)化为Skolem标准形：
引入Skolem函数f(x)，得∀xP(x,f(x))

## 2.7 基本推理公式及其证明方法

### 2.7.1 全称指定规则(US)

若∀xA(x)为真，则对任意个体a，A(a)为真。
记作：∀xA(x) ⊢ A(y), ∀xA(x) ⊢ A(c)

### 2.7.2 全称推广规则(UG)

如果对任意个体y，A(y)都为真，则∀xA(x)为真。
记作：A(y) ⊢ ∀xA(x)

### 2.7.3 存在指定规则(ES)

如果∃xA(x)为真，则存在某个特定的c，使A(c)为真。
记作：∃xA(x) ⊢ A(c)

### 2.7.4 存在推广规则(EG)

如果对某个特定个体c，A(c)为真，则∃xA(x)为真。
记作：A(c) ⊢ ∃xA(x)

## 2.8 谓词逻辑的推理规则与推理演算

谓词逻辑的推理规则扩展了命题逻辑的推理规则，加入了量词规则。

### 2.8.1 推理演算示例

**例2.8.1** 证明：∀x(P(x)→Q(x)), ∃xP(x) ⊢ ∃xQ(x)

证明：
1. ∀x(P(x)→Q(x))        (前提)
2. ∃xP(x)                (前提)
3. P(c)                  (2)ES
4. P(c)→Q(c)             (1)US
5. Q(c)                  (3)(4)分离规则
6. ∃xQ(x)                (5)EG

### 2.8.2 无效推理的反例

要证明一个推理无效，只需找到一个解释使得前提为真而结论为假。

**例2.8.2** 证明：∀x(P(x)→Q(x)) ⊭ ∀xP(x)→∀xQ(x) 是不成立的
此推理是有效的，实际上这个例子是有效的推理。

## 2.9 归结推理法

归结法是谓词逻辑中重要的自动化推理方法。

### 2.9.1 子句集

谓词逻辑公式可通过以下步骤化为子句集：
1. 消去蕴含和等价
2. 否定深入到谓词前
3. 变元标准化
4. 消去存在量词（引入Skolem函数）
5. 化为前束形
6. 消去全称量词
7. 化母式为合取范式
8. 写成子句集

### 2.9.2 归结过程

通过寻找互补文字对进行归结，若能归结出空子句，则原公式集不可满足。

## 2.10 谓词逻辑的语义

谓词逻辑的解释I包含：
1. 非空集合D（论域）
2. 对每个常元指定D中的一个元素
3. 对每个n元函数符号指定一个Dⁿ到D的映射
4. 对每个n元谓词符号指定一个从Dⁿ到{T,F}的映射

## 本章小结

1. 谓词逻辑通过谓词和量词揭示了命题的内部结构
2. 全称量词(∀)表示"对所有"，存在量词(∃)表示"存在"
3. 自然语句的形式化需要正确选择谓词和量词
4. 量词否定有特殊等值式：¬∀x等价于∃x¬，¬∃x等价于∀x¬
5. 前束范式是量词在前、矩阵在后的特殊形式
6. Skolem标准形是处理存在量词的有效方法
7. 谓词逻辑推理规则在命题逻辑基础上增加了量词规则
8. 归结法是自动化推理的重要方法

## 课后练习

### 选择题

1. 在谓词逻辑中，表达式∀xP(x) → P(a)是：
   A. 永真式
   B. 永假式
   C. 可满足式
   D. 不确定

2. 设论域为整数集，P(x)表示"x是偶数"，Q(x)表示"x是素数"，则∀x(P(x) → Q(x))的真值是：
   A. 真
   B. 假
   C. 无法确定
   D. 以上都不对

3. 下列等值式中正确的是：
   A. ¬∀xP(x) ⇔ ∀x¬P(x)
   B. ¬∃xP(x) ⇔ ∃x¬P(x)  
   C. ¬∀xP(x) ⇔ ∃x¬P(x)
   D. ¬∃xP(x) ⇔ ∀x¬P(x)

### 解答题

1. 将以下语句形式化为谓词逻辑公式：
   a) 每个人都有一个父亲。
   b) 有些学生不喜欢任何课程。
   c) 没有不犯错误的人。
   
2. 将公式∀x(P(x) → ∃y(Q(y) ∧ R(x,y)))化为前束范式。

3. 证明：∀x(P(x) ∨ Q(x)), ¬P(a) ⊢ Q(a)

4. 使用归结法证明：从前提∀x(P(x) → Q(x))和P(a)可以推出Q(a)

### 练习题答案

#### 选择题

1. A - 这是全称指定规则，是永真式
2. B - "如果x是偶数，则x是素数"，例如当x=4时，4是偶数但不是素数，所以为假
3. C 和 D 都是正确的，但题目要求选一个，C是量词否定的标准等值式

#### 解答题

1. 形式化语句：
   a) 设P(x,y)表示"y是x的父亲"，则公式为：∀x∃yP(x,y)
   b) 设S(x)表示"x是学生"，C(y)表示"y是课程"，L(x,y)表示"x喜欢y"，则公式为：∃x(S(x) ∧ ∀y(C(y) → ¬L(x,y)))
   c) 设H(x)表示"x是人"，M(x)表示"x犯错误"，则公式为：¬∃x(H(x) ∧ ¬M(x)) 或 ∀x(H(x) → M(x))

2. 化为前束范式：
   ∀x(P(x) → ∃y(Q(y) ∧ R(x,y)))
   = ∀x(¬P(x) ∨ ∃y(Q(y) ∧ R(x,y)))
   = ∀x∃y(¬P(x) ∨ (Q(y) ∧ R(x,y)))
   = ∀x∃y(¬P(x) ∨ Q(y) ∧ ¬P(x) ∨ R(x,y))

3. 证明：
   1) ∀x(P(x) ∨ Q(x))     (前提)
   2) ¬P(a)                (前提)
   3) P(a) ∨ Q(a)          (1)US
   4) Q(a)                 (2)(3)析取三段论

4. 归结证明：
   要证明从∀x(P(x) → Q(x))和P(a)可以推出Q(a)，我们反证
   即证明{∀x(P(x) → Q(x)), P(a), ¬Q(a)}不可满足
   
   化为子句集：
   1) ¬P(x) ∨ Q(x)         (来自∀x(P(x) → Q(x)))
   2) P(a)                 (事实)
   3) ¬Q(a)                (否定结论)
   
   归结过程：
   4) 从(1)和(2)，令x=a，得到：Q(a)
   5) 从(4)和(3)归结得到：□（空子句）
   
   所以原推理有效。