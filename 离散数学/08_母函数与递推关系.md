# 第8章 母函数与递推关系

## 8.1 母函数

### 8.1.1 普通母函数

**定义8.1.1** 对于序列{a₀, a₁, a₂, ...}，其**普通母函数**（或称生成函数）定义为：
G(x) = a₀ + a₁x + a₂x² + a₃x³ + ... = Σ_{n≥0} aₙxⁿ

**例8.1.1** 
- 序列{1, 1, 1, 1, ...}的母函数：G(x) = 1 + x + x² + x³ + ... = 1/(1-x)
- 序列{1, 2, 3, 4, ...}的母函数：G(x) = 1 + 2x + 3x² + 4x³ + ... = 1/(1-x)²

### 8.1.2 常见序列的母函数

1. **常数序列**{1, 1, 1, ...}：G(x) = 1/(1-x)
2. **自然数序列**{0, 1, 2, 3, ...}：G(x) = x/(1-x)²
3. **平方序列**{0, 1, 4, 9, ...}：G(x) = x(1+x)/(1-x)³
4. **二项式系数序列**{C(r,0), C(r,1), ..., C(r,r), 0, 0, ...}：G(x) = (1+x)^r
5. **无穷二项式系数序列**{C(r+k,k)} (k≥0)：G(x) = 1/(1-x)^(r+1)

### 8.1.3 母函数的运算

设A(x)和B(x)分别是序列{aₙ}和{bₙ}的母函数：

1. **加法**：A(x) + B(x) 是序列{aₙ + bₙ}的母函数
2. **数乘**：c·A(x) 是序列{c·aₙ}的母函数
3. **移位**：
   - x·A(x) 是序列{0, a₀, a₁, a₂, ...}的母函数
   - A(x)/x 是序列{a₁, a₂, a₃, ...}的母函数（当a₀=0时）
4. **微分**：A'(x) 是序列{(n+1)a_{n+1}}的母函数
5. **积分**：∫₀ˣ A(t)dt 是序列{a_{n-1}/n}（n≥1时）的母函数

### 8.1.4 母函数的应用

**例8.1.2** 求序列{1, 2, 3, 4, ...}的母函数。
解：序列{1, 1, 1, ...}的母函数是1/(1-x)，对其求导得1/(1-x)²，即为{1, 2, 3, 4, ...}的母函数。

## 8.2 递推关系

### 8.2.1 递推关系的定义

**定义8.2.1** 如果数列{aₙ}的某一项与它的前面若干项之间有关系式：
aₙ = f(a_{n-1}, a_{n-2}, ..., a_{n-k})
则称此关系为**递推关系**或**递归关系**。

### 8.2.2 递推关系的阶数

递推关系中涉及的项数k称为递推关系的**阶数**。

## 8.3 Fibonacci数列

### 8.3.1 Fibonacci数列的定义

F₀ = 0, F₁ = 1, Fₙ = F_{n-1} + F_{n-2} (n≥2)

数列为：0, 1, 1, 2, 3, 5, 8, 13, 21, 34, ...

### 8.3.2 Fibonacci数列的性质

1. **母函数**：F(x) = x/(1-x-x²)
2. **通项公式**（Binet公式）：Fₙ = (αⁿ - βⁿ)/√5
   其中α = (1+√5)/2, β = (1-√5)/2
3. **极限性质**：lim(n→∞) F_{n+1}/Fₙ = α = (1+√5)/2（黄金比例）

## 8.4 线性常系数递推关系

### 8.4.1 齐次线性递推关系

**定义8.4.1** 形如：
aₙ = c₁a_{n-1} + c₂a_{n-2} + ... + cₖa_{n-k}
的递推关系称为**k阶齐次线性常系数递推关系**。

### 8.4.2 特征方程法

对于递推关系aₙ = c₁a_{n-1} + ... + cₖa_{n-k}，其**特征方程**为：
xᵏ - c₁x^{k-1} - ... - cₖ = 0

**定理8.4.1** 如果特征方程有k个不同根r₁, r₂, ..., rₖ，则通解为：
aₙ = α₁r₁ⁿ + α₂r₂ⁿ + ... + αₖrₖⁿ
其中系数αᵢ由初始条件确定。

**定理8.4.2** 如果r是特征方程的m重根，则对应的解包含：
(β₀ + β₁n + ... + β_{m-1}n^{m-1})rⁿ

### 8.4.3 非齐次线性递推关系

**定义8.4.2** 形如：
aₙ = c₁a_{n-1} + ... + cₖa_{n-k} + f(n)
的递推关系称为**非齐次线性常系数递推关系**。

**解的结构**：通解 = 对应齐次方程通解 + 特解

### 8.4.4 求解示例

**例8.4.1** 解递推关系：aₙ = 5a_{n-1} - 6a_{n-2}, a₀ = 1, a₁ = 0
解：
特征方程：x² - 5x + 6 = 0，解得x₁ = 2, x₂ = 3
通解：aₙ = α₁·2ⁿ + α₂·3ⁿ
由初始条件：
- a₀ = α₁ + α₂ = 1
- a₁ = 2α₁ + 3α₂ = 0
解得α₁ = 3, α₂ = -2
所以aₙ = 3·2ⁿ - 2·3ⁿ

## 8.5 整数的拆分和Ferrers图像

### 8.5.1 整数的拆分

**定义8.5.1** 将正整数n表示为正整数之和的方法称为n的**拆分**。

如：4 = 4 = 3+1 = 2+2 = 2+1+1 = 1+1+1+1，所以p(4) = 5

### 8.5.2 Ferrers图像

**Ferrers图像**是用点阵表示整数拆分的图形方法。

**例8.5.1** 拆分7 = 4 + 2 + 1的Ferrers图像：
• • • •
• •
• 

### 8.5.3 共轭拆分

将Ferrers图像转置得到的拆分称为**共轭拆分**。

**性质**：最大加数为k的n的拆分数 = 恰有k个加数的n的拆分数

## 8.6 指数型母函数

### 8.6.1 指数型母函数的定义

序列{a₀, a₁, a₂, ...}的**指数型母函数**定义为：
E(x) = a₀ + a₁x/1! + a₂x²/2! + a₃x³/3! + ... = Σ_{n≥0} aₙxⁿ/n!

### 8.6.2 指数型母函数的应用

指数型母函数主要用于解决排列问题。

**例8.6.1** 
- {1, 1, 1, ...}的指数型母函数：E(x) = eˣ
- {1, 1, 2, 6, 24, ...}（即{n!}）的指数型母函数：E(x) = 1/(1-x)

## 8.7 母函数和递推关系应用举例

### 8.7.1 Catalan数

**定义8.7.1** Catalan数定义为：Cₙ = C(2n,n)/(n+1)

**递推关系**：C₀ = 1, Cₙ = Σ_{i=0}^{n-1} CᵢC_{n-1-i}

**母函数**：C(x) = (1-√(1-4x))/(2x)

**应用**：
- n+1个数的乘法方案数
- n+1边形的三角剖分方案数
- n个元素的出栈序列数
- 括号匹配方案数

### 8.7.2 母函数法求解递推关系

**例8.7.1** 用母函数解Fibonacci数列的递推关系：
F₀=0, F₁=1, Fₙ = F_{n-1} + F_{n-2} (n≥2)

设F(x) = Σ Fₙxⁿ，根据递推关系：
F(x) - F₀ - F₁x = x(F(x) - F₀) + x²F(x)
F(x) - x = xF(x) + x²F(x)
F(x) = x/(1-x-x²)

### 8.7.3 分割数

p(n)表示整数n的拆分数（不考虑加数顺序）。

**母函数**：P(x) = ∏_{k=1}^∞ 1/(1-xᵏ)

## 8.8 错排问题

### 8.8.1 错排数的递推关系

**定理8.8.1** 错排数D(n)满足递推关系：
D(n) = (n-1)[D(n-1) + D(n-2)]，n≥2
其中D(0) = 1, D(1) = 0

### 8.8.2 错排数的公式

D(n) = n! Σ_{k=0}^n (-1)ᵏ/k! ≈ n!/e

## 8.9 Stirling数

### 8.9.1 第一类Stirling数

**定义8.9.1** 第一类Stirling数s(n,k)是x(x-1)(x-2)...(x-n+1)展开式中xᵏ的系数。

**递推关系**：s(n,k) = s(n-1,k-1) - (n-1)s(n-1,k)

**组合意义**：(-1)^{n-k}s(n,k)表示n个元素的排列中恰好有k个循环的个数。

### 8.9.2 第二类Stirling数

**定义8.9.2** 第二类Stirling数S(n,k)表示将n个不同的元素划分成k个非空子集的方法数。

**递推关系**：S(n,k) = S(n-1,k-1) + k·S(n-1,k)

**公式**：S(n,k) = (1/k!) Σ_{j=0}^k (-1)^{k-j} C(k,j) jⁿ

## 8.10 Catalan数

### 8.10.1 Catalan数的定义

**定义8.10.1** 
Cₙ = (1/(n+1))C(2n,n) = C(2n,n) - C(2n,n-1)

**前几项**：C₀=1, C₁=1, C₂=2, C₃=5, C₄=14, C₅=42

### 8.10.2 Catalan数的递推关系

C₀ = 1, Cₙ = Σ_{i=0}^{n-1} Cᵢ·C_{n-1-i}

### 8.10.3 Catalan数的应用

1. **括号匹配**：n对括号的正确匹配方案数
2. **出栈序列**：n个元素的所有可能出栈序列数
3. **二叉树**：n个内部节点的不同二叉树个数
4. **多边形三角剖分**：(n+2)边形的三角剖分数
5. **路径计数**：从(0,0)到(n,n)且不越过对角线的单调路径数

## 本章小结

1. 母函数是处理序列问题的有力工具，分为普通型和指数型
2. 递推关系描述了数列中项之间的关系，是离散数学的重要内容
3. Fibonacci数列是最著名的递推数列之一
4. 线性常系数递推关系可用特征根法求解
5. 整数拆分问题与Ferrers图像有密切关系
6. Catalan数在组合数学中有广泛应用
7. Stirling数是重要的组合数，分为第一类和第二类

## 课后练习

### 选择题

1. 序列{1, 1, 1, 1, ...}的普通母函数是：
   A. 1/(1+x)
   B. 1/(1-x)
   C. x/(1-x)
   D. x/(1+x)

2. Fibonacci数列Fₙ的母函数是：
   A. 1/(1-x-x²)
   B. x/(1-x-x²)
   C. x/(1-x+x²)
   D. 1/(1-x+x²)

3. 下列哪个是第二类Stirling数S(n,k)的递推关系？
   A. S(n,k) = S(n-1,k-1) + (n-1)S(n-1,k)
   B. S(n,k) = S(n-1,k-1) + k·S(n-1,k)
   C. S(n,k) = S(n-1,k) + S(n-1,k-1)
   D. S(n,k) = (n-1)[S(n-1,k) + S(n-2,k)]

### 解答题

1. 用母函数方法求解递推关系：aₙ = 3a_{n-1} - 2a_{n-2} (n≥2)，a₀=1, a₁=2

2. 求Catalan数C₃的值，并列举其在括号匹配中的具体应用（所有方案）。

3. 求将整数5拆分为正整数之和的全部方案数p(5)。

4. 证明第二类Stirling数的递推关系：S(n,k) = S(n-1,k-1) + k·S(n-1,k)

5. 求解递推关系：aₙ = 4a_{n-1} - 4a_{n-2} + 2ⁿ (n≥2)，a₀=1, a₁=3

### 练习题答案

#### 选择题

1. B - 几何级数1+x+x²+... = 1/(1-x)
2. B - Fibonacci递推关系可推导出母函数为x/(1-x-x²)
3. B - 第二类Stirling数的标准递推关系

#### 解答题

1. 解：
   设A(x) = Σ aₙxⁿ，由递推关系：
   aₙ = 3a_{n-1} - 2a_{n-2}
   
   两边同时乘以xⁿ并求和（n≥2）：
   Σ_{n≥2} aₙxⁿ = 3x Σ_{n≥2} a_{n-1}x^{n-1} - 2x² Σ_{n≥2} a_{n-2}x^{n-2}
   
   A(x) - a₀ - a₁x = 3x(A(x) - a₀) - 2x²A(x)
   A(x) - 1 - 2x = 3x(A(x) - 1) - 2x²A(x)
   A(x) - 1 - 2x = 3xA(x) - 3x - 2x²A(x)
   A(x)(1 - 3x + 2x²) = 1 - x
   A(x) = (1-x)/(1-3x+2x²) = (1-x)/((1-x)(1-2x)) = 1/(1-2x)
   
   所以aₙ = 2ⁿ

2. 解：
   C₃ = (1/4)C(6,3) = (1/4)×20 = 5
   
   3对括号的所有匹配方案：
   ((()))、(()())、(())()、()(())、()()()

3. 解：
   5的所有拆分方案：
   (5), (4,1), (3,2), (3,1,1), (2,2,1), (2,1,1,1), (1,1,1,1,1)
   
   所以p(5) = 7

4. 证明：
   S(n,k)表示将n个不同元素分成k个非空子集的方法数。
   
   考虑元素n的归属：
   (1) 元素n单独组成一个子集：剩下n-1个元素分成k-1个非空子集，方法数为S(n-1,k-1)
   (2) 元素n加入已有的子集：先将n-1个元素分成k个非空子集，再将元素n放入其中一个子集，方法数为k·S(n-1,k)
   
   所以S(n,k) = S(n-1,k-1) + k·S(n-1,k)

5. 解：
   齐次部分：aₙ = 4a_{n-1} - 4a_{n-2}
   特征方程：x² - 4x + 4 = 0，(x-2)² = 0，x = 2（二重根）
   齐次通解：aₙ^h = (α + βn)2ⁿ
   
   非齐次特解：由于f(n) = 2ⁿ，且2是特征根（二重根）
   设特解为aₙ^p = γn²2ⁿ
   代入递推关系：γn²2ⁿ = 4γ(n-1)²2^{n-1} - 4γ(n-2)²2^{n-2} + 2ⁿ
   两边同除以2^{n-2}：4γn² = 8γ(n-1)² - 4γ(n-2)² + 4
   展开：4γn² = 8γ(n²-2n+1) - 4γ(n²-4n+4) + 4
   4γn² = 8γn² - 16γn + 8γ - 4γn² + 16γn - 16γ + 4
   4γn² = 4γn² - 8γ + 4
   所以-8γ + 4 = 0，γ = 1/2
   
   通解：aₙ = (α + βn)2ⁿ + (1/2)n²2ⁿ
   
   由初始条件：
   a₀ = α = 1
   a₁ = (α + β)2 + 1/2 × 1 × 2 = 2(α + β) + 1 = 3
   所以2(1 + β) + 1 = 3，得β = 0
   
   所以aₙ = 2ⁿ + (1/2)n²2ⁿ = (1 + n²/2)2ⁿ