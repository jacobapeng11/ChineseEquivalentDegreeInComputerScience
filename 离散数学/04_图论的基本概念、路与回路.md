# 第4章 图论的基本概念、路与回路

## 4.1 图的基本概念与性质

### 4.1.1 图的定义

**图**G是一个有序三元组<V, E, φ>，其中：
- V是一个非空集合，其元素称为**顶点**（或结点）
- E是另一个集合，其元素称为**边**
- φ是关联映射，将E中的每个元素映射到V中的一个无序对（对无向图）或有序对（对有向图）

通常简记为G = <V, E>或G = (V, E)，其中V是顶点集，E是边集。

### 4.1.2 图的分类

1. **无向图**：边没有方向
2. **有向图**（或**弧图**）：边有方向
3. **简单图**：无自环（边的两个端点相同），无平行边
4. **多重图**：允许有多重边
5. **混合图**：既有有向边又有无向边

### 4.1.3 图的术语

- **相邻**：若两个顶点由一条边连接，则称这两个顶点相邻
- **关联**：顶点与它所连接的边关联
- **度**：顶点v的度deg(v)是与v关联的边的数目
- **入度**：有向图中指向顶点v的边的数目
- **出度**：有向图中从顶点v出发的边的数目
- **孤立点**：度为0的顶点
- **悬挂点**：度为1的顶点

### 4.1.4 握手定理

**定理4.1.1**（握手定理）：对于任意图G = <V, E>，所有顶点的度数之和等于边数的两倍。
即：∑_{v∈V} deg(v) = 2|E|

**推论**：任何图中度数为奇数的顶点个数必为偶数。

### 4.1.5 特殊图

1. **完全图**K_n：n个顶点的简单无向图，每对顶点间都有一条边
2. **完全有向图**：n个顶点的简单有向图，每对顶点间都有两条方向相反的有向边
3. **二部图**：顶点集可划分为两个子集V₁和V₂，使每条边的两个端点分别属于V₁和V₂
4. **完全二部图**K_{m,n}：二部图，且V₁中每个顶点与V₂中每个顶点相邻

## 4.2 图的代数表示

### 4.2.1 邻接矩阵

对于n阶图G = (V, E)，其中V = {v₁, v₂, ..., vₙ}，其**邻接矩阵**A = (aᵢⱼ)ₙₓₙ定义为：

aᵢⱼ = {
    1,  若vᵢ与vⱼ相邻
    0,  否则
}

对于有向图，aᵢⱼ = 1表示存在从vᵢ到vⱼ的有向边。

### 4.2.2 关联矩阵

对于n阶m边的图G = (V, E)，其中V = {v₁, v₂, ..., vₙ}，E = {e₁, e₂, ..., eₘ}，其**关联矩阵**B = (bᵢⱼ)ₙₓₘ定义为：

对于无向图：
bᵢⱼ = {
    1,  若顶点vᵢ与边eⱼ关联
    0,  否则
}

对于有向图：
bᵢⱼ = {
     1,  若边eⱼ从vᵢ出发
    -1,  若边eⱼ进入vᵢ
     0,  否则
}

### 4.2.3 邻接表

邻接表是图的链式存储结构，对每个顶点建立一个链表，链表中存储与该顶点相邻的所有顶点。

## 4.3 途径、路、回路、迹的定义

### 4.3.1 途径与迹

- **途径**（通路或链）：由顶点和边交替组成的序列，如：v₀e₁v₁e₂v₂...eₖvₖ
- **迹**：边不重复的途径
- **道路**（或**通路**）：顶点不重复的迹
- **回路**：起点与终点相同的途径
- **闭迹**：边不重复的回路
- **圈**：顶点不重复（除头尾相同外）的回路

### 4.3.2 图的连通性

- **连通图**：任意两个顶点间都存在通路
- **连通分量**：图的极大连通子图
- **点连通度**：使得图不连通或变成平凡图需要删除的最少顶点数
- **边连通度**：使得图不连通需要删除的最少边数

**定理4.3.1**：对于任意图G，有κ(G) ≤ λ(G) ≤ δ(G)，其中κ为点连通度，λ为边连通度，δ为最小度。

## 4.4 欧拉环游（欧拉闭迹）与欧拉迹

### 4.4.1 欧拉图的概念

- **欧拉迹**：包含图中所有边的迹
- **欧拉回路**：包含图中所有边的回路
- **欧拉图**：具有欧拉回路的图
- **半欧拉图**：有欧拉迹但无欧拉回路的图

### 4.4.2 欧拉图的判定定理

**定理4.4.1**（无向图的欧拉定理）：连通图G是欧拉图当且仅当G的所有顶点度数都是偶数。

**定理4.4.2**（无向图的半欧拉定理）：连通图G是半欧拉图当且仅当G恰好有两个奇度顶点。

**定理4.4.3**（有向图的欧拉定理）：连通的有向图G是欧拉图当且仅当对任意顶点v，出度等于入度。

**例4.4.1** 七桥问题：Königsberg城的七座桥不能不重复地遍历一遍再回到起点，因为图中有4个奇度顶点。

## 4.5 哈密顿路与回路

### 4.5.1 哈密顿图的概念

- **哈密顿路**：包含图中所有顶点的通路
- **哈密顿回路**：包含图中所有顶点的圈
- **哈密顿图**：具有哈密顿回路的图
- **半哈密顿图**：有哈密顿路但无哈密顿回路的图

### 4.5.2 哈密顿图的判定

哈密顿图的判定比欧拉图困难得多，目前没有充分必要条件，但有以下充分条件：

**定理4.5.1**（Dirac定理）：设G是n阶简单图，若对所有顶点v，都有deg(v) ≥ n/2，则G是哈密顿图。

**定理4.5.2**（Ore定理）：设G是n阶简单图，若对于任意不相邻的顶点u和v，都有deg(u) + deg(v) ≥ n，则G是哈密顿图。

### 4.5.3 哈密顿图的性质

哈密顿性不是局部性质，不能像欧拉性那样通过顶点度数直接判断。

## 4.6 最短路径

### 4.6.1 距离的概念

在图G中，从顶点u到顶点v的**距离**d(u,v)是u和v之间最短路径的长度。

### 4.6.2 最短路径算法

#### Dijkstra算法

用于求解单源最短路径问题，即求图中一个顶点到其他各顶点的最短路径。

算法步骤：
1. 初始化：给源点s距离为0，其他顶点距离为∞
2. 选择距离最小且未访问的顶点u
3. 更新u的邻接顶点的距离
4. 重复步骤2-3，直到所有顶点被访问

#### Floyd-Warshall算法

用于求解多源最短路径问题，即求图中每对顶点之间的最短路径。

### 4.6.3 关键路径

在有向无环图（DAG）中，关键路径是从源点到汇点的最长路径，它决定了整个工程的最短完成时间。

## 4.7 连通性

### 4.7.1 无向图的连通性

- **连通**：任意两个顶点间都存在路径
- **k-连通**：至少需要删除k个顶点才能使图不连通或平凡化
- **k-边连通**：至少需要删除k条边才能使图不连通

### 4.7.2 有向图的连通性

- **弱连通**：忽略边的方向后得到的无向图是连通的
- **单向连通**：对任意两个顶点u、v，存在从u到v或从v到u的有向路径
- **强连通**：对任意两个顶点u、v，都存在从u到v和从v到u的有向路径

### 4.7.3 连通性的判定

**定理4.7.1**：n阶简单图G，若δ(G) ≥ (n-1)/2，则G是连通的。

## 4.8 有向图

### 4.8.1 有向图的基本概念

- **有向图**（或**有向图**）：每条边都有方向的图
- **入度**：指向顶点的边的条数
- **出度**：从顶点出发的边的条数
- **度**：入度+出度

### 4.8.2 有向图的性质

**定理4.8.1**：在任意有向图中，所有顶点的入度之和等于出度之和，且等于边数。

### 4.8.3 有向图的连通性

如上所述，有向图有三种连通性的概念。

## 本章小结

1. 图是由顶点集和边集组成的数学结构，可用于建模对象间的关系
2. 图的分类包括有向图、无向图、简单图、多重图等
3. 邻接矩阵、关联矩阵和邻接表是图的主要表示方法
4. 途径、路、回路、迹等概念描述了图中顶点和边的连接方式
5. 欧拉图和哈密顿图是两种重要的特殊图类，分别涉及边的遍历和顶点的遍历
6. 最短路径算法（如Dijkstra算法）是图论中的重要应用
7. 连通性描述了图中顶点间的可达性，包括点连通度和边连通度
8. 有向图中的边具有方向性，其性质与无向图有所不同

## 课后练习

### 选择题

1. 在一个有向图中，所有顶点的入度之和等于出度之和，这个和等于：
   A. 顶点数
   B. 边数
   C. 顶点数-1
   D. 边数-1

2. 设无向简单图G有12条边，3个4度顶点，2个3度顶点，其余顶点度数均为2，则G的顶点数为：
   A. 8
   B. 9
   C. 10
   D. 11

3. 无向图G是欧拉图的充分必要条件是：
   A. G连通且所有顶点度数为偶数
   B. G连通且有两个奇度顶点
   C. G连通且最多有两个奇度顶点
   D. G中所有顶点度数为偶数

### 解答题

1. 设无向图G的顶点集V = {v₁, v₂, v₃, v₄, v₅}，边集E = {e₁, e₂, e₃, e₄, e₅}，其中e₁ = (v₁,v₂), e₂ = (v₂,v₃), e₃ = (v₁,v₃), e₄ = (v₃,v₄), e₅ = (v₄,v₅)，试画出图G，并写出它的邻接矩阵和关联矩阵。

2. 证明：在n阶简单图中，若每个顶点的度数都大于等于(n-1)/2，则图是连通的。

3. 试判断下图是否为欧拉图或半欧拉图，如果是，请给出欧拉回路或欧拉迹：
   图的顶点为a, b, c, d, e，边为(a,b), (a,c), (b,c), (b,d), (c,e), (d,e), (d,c)。

4. 使用Dijkstra算法求从顶点A到其他各顶点的最短路径，图的边权重如下：
   (A,B)=4, (A,C)=2, (B,C)=1, (B,D)=5, (C,D)=8, (C,E)=10, (D,E)=2

### 练习题答案

#### 选择题

1. B - 有向图中每条有向边贡献一个入度和一个出度，所以入度之和等于出度之和等于边数
2. B - 设总顶点数为n，则3×4 + 2×3 + (n-5)×2 = 2×12 = 24，解得n=9
3. A - 这是欧拉图的基本判定定理：连通且所有顶点度数为偶数

#### 解答题

1. 解：
   图G的形状：v₁与v₂, v₃相连，v₂与v₁, v₃相连，v₃与v₁, v₂, v₄相连，v₄与v₃, v₅相连，v₅与v₄相连
   
   邻接矩阵：
   ```
     v₁ v₂ v₃ v₄ v₅
   v₁  0  1  1  0  0
   v₂  1  0  1  0  0
   v₃  1  1  0  1  0
   v₄  0  0  1  0  1
   v₅  0  0  0  1  0
   ```
   
   关联矩阵：
   ```
      e₁ e₂ e₃ e₄ e₅
   v₁  1  0  1  0  0
   v₂  1  1  0  0  0
   v₃  0  1  1  1  0
   v₄  0  0  0  1  1
   v₅  0  0  0  0  1
   ```

2. 证明：
   用反证法。假设图G不连通，则G至少有两个连通分量。
   设其中一个连通分量有k个顶点，则其补图有n-k个顶点。
   任取连通分量中的一个顶点u，u最多只能与该连通分量中其他k-1个顶点相邻，
   所以u的度数最多为k-1。
   由于每个顶点的度数都大于等于(n-1)/2，所以k-1 ≥ (n-1)/2，即k ≥ (n-1)/2 + 1。
   同样，任取补图中的一个顶点v，v最多只能与补图中其他n-k-1个顶点相邻，
   所以v的度数最多为n-k-1。
   所以n-k-1 ≥ (n-1)/2，即k ≤ (n-1)/2。
   但k ≥ (n-1)/2 + 1 > (n-1)/2，与k ≤ (n-1)/2矛盾。
   所以图G是连通的。

3. 解：
   顶点度数：d(a)=2, d(b)=3, d(c)=4, d(d)=3, d(e)=2
   度数为奇数的顶点有：b, d（共2个）
   图是连通的，所以该图是半欧拉图（有欧拉迹但没有欧拉回路）
   一条欧拉迹：e→d→b→a→c→b→c→d→c→e

4. 解：
   Dijkstra算法求解过程：
   
   初始：A到A为0，A到其他顶点为∞
   S = {} (已确定最短路的顶点集)
   
   步骤1：选择A（距离0），更新邻接点：B(4), C(2)
   S = {A}
   
   步骤2：选择C（距离2），更新邻接点：B(min(4,2+1)=3), D(2+8=10), E(2+10=12)
   S = {A, C}
   
   步骤3：选择B（距离3），更新邻接点：D(min(10,3+5)=8)
   S = {A, C, B}
   
   步骤4：选择D（距离8），更新邻接点：E(min(12,8+2)=10)
   S = {A, C, B, D}
   
   步骤5：选择E（距离10）
   S = {A, C, B, D, E}
   
   最短距离：
   A到A：0
   A到B：3
   A到C：2
   A到D：8
   A到E：10